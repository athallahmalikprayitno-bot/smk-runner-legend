<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SMK RUNNER LEGEND</title>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
  background: linear-gradient(135deg, #70e1f5, #ffd194);
  height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
  font-family: 'Poppins', sans-serif;
  overflow: hidden;
}
canvas {
  background-image: url('assets/image/BG.png');
  background-repeat: no-repeat;
  background-position: center;
  background-size: cover;
  border: 3px solid #000;
  display: none;
}

/* Loading Screen */
#loadingScreen {
  position: fixed;
  inset: 0;
  background: black;
  color: white;
  font-size: 30px;
  display: flex;
  justify-content: center;
  align-items: center;
  flex-direction: column;
  z-index: 9999;
}

/* Main Menu */
#mainMenu {
  position: fixed;
  inset: 0;
  background: linear-gradient(180deg, #2c3e50, #3498db);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  color: white;
  text-align: center;
  z-index: 1000; /* üÜï supaya tombol bisa diklik */
}

/* üî• LOGO STYLE */
#gameLogo {
  width: 200px;
  height: auto;
  border-radius: 15px;
  box-shadow: 0 4px 20px rgba(0,0,0,0.5);
  margin-bottom: 25px;
  animation: floatLogo 3s ease-in-out infinite;
}
@keyframes floatLogo {
  0% { transform: translateY(0); }
  50% { transform: translateY(-10px); }
  100% { transform: translateY(0); }
}
#mainMenu h1 {
  font-size: 60px;
  margin-bottom: 40px;
  animation: glow 2s ease-in-out infinite alternate;
  letter-spacing: 2px;
}
@keyframes glow {
  from { text-shadow: 0 0 10px #fff, 0 0 20px #0ff; }
  to { text-shadow: 0 0 25px #ff0, 0 0 50px #f0f; }
}
.menu-button {
  padding: 15px 50px;
  margin: 10px;
  font-size: 22px;
  color: #fff;
  background: linear-gradient(45deg, #16a085, #27ae60);
  border: none;
  border-radius: 50px;
  cursor: pointer;
  transition: all 0.3s ease;
  box-shadow: 0 5px 15px rgba(0,0,0,0.2);
}
.menu-button:hover {
  transform: scale(1.1);
  background: linear-gradient(45deg, #1abc9c, #2ecc71);
  box-shadow: 0 10px 25px rgba(0,0,0,0.4);
}
#highScore {
  font-size: 20px;
  margin-top: 25px;
  color: #f1f1f1;
}

/* Option Screen */
#optionScreen {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.9);
  color: white;
  display: none;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: left;
  padding: 20px;
  z-index: 2000;
}
#optionScreen h2 {
  font-size: 36px;
  margin-bottom: 20px;
  color: #00ffff;
  text-shadow: 0 0 10px #00ffff;
}
.option-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  background: rgba(255,255,255,0.05);
  border: 2px solid #00ffff;
  border-radius: 15px;
  padding: 15px 25px;
  margin: 10px;
  width: 250px;
  text-align: center;
  transition: all 0.3s;
}
.option-item:hover {
  background: rgba(255,255,255,0.15);
  transform: scale(1.05);
}
.option-item label {
  font-size: 20px;
  color: white;
  margin-bottom: 8px;
}
.option-item select {
  font-size: 18px;
  padding: 8px 12px;
  color: white;
  background-color: black;
  border: 2px solid #00ffff;
  border-radius: 10px;
  cursor: pointer;
  outline: none;
}
#optionScreen button {
  margin-top: 40px;
  padding: 10px 30px;
  background: #27ae60;
  border: none;
  border-radius: 30px;
  color: white;
  cursor: pointer;
  font-size: 20px;
}

/* Overlay */
#overlay {
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  display: flex; justify-content: center; align-items: center;
  flex-direction: column;
  font-family: Arial, sans-serif;
  font-size: 40px; color: red;
  text-shadow: 2px 2px 4px #000;
  z-index: 3000;
  display: none;
}
#overlay p {
  font-size: 20px;
  color: white;
  margin-top: 10px;
}
#overlay button {
  margin-top: 20px;
  padding: 10px 25px;
  background: #27ae60;
  border: none;
  border-radius: 30px;
  color: white;
  font-size: 20px;
  cursor: pointer;
}
</style>
</head>
<body>
<canvas id="gameCanvas" width="800" height="400"></canvas>

<div id="loadingScreen"><h2>Loading...</h2></div>

<div id="mainMenu">
  <img id="gameLogo" src="assets/image/Logo.jpg" alt="Game Logo">
  <h1>SMK RUNNER LEGEND</h1>
  <button class="menu-button" id="playBtn">Mulai Main</button>
  <button class="menu-button" id="optionBtn">Pengaturan</button>
  <div id="highScore"></div>
</div>

<div id="optionScreen">
  <h2>Pengaturan ‚öôÔ∏è</h2>
  <div class="option-item">
    <label>üéµ Suara:</label>
    <select id="soundOption">
      <option value="on">On</option>
      <option value="off">Off</option>
    </select>
  </div>
  <div class="option-item">
    <label>üî• Kesulitan:</label>
    <select id="difficulty">
      <option value="easy">Easy</option>
      <option value="normal" selected>Normal</option>
      <option value="hard">Hard</option>
      <option value="veryhard">Very Hard</option>
    </select>
  </div>
  <div class="option-item">
    <label>üé∂ Pilih Lagu BGM:</label>
    <select id="bgmSelect">
      <option value="assets/audio/Gone gone gone.mp3">Gone gone gone</option>
      <option value="assets/audio/Take me home.mp3">Take me home</option>
      <option value="assets/audio/Night Changes.mp3">Night Changes</option>
      <option value="assets/audio/Best friend.mp3">Best friend</option>
      <option value="assets/audio/everything u are.mp3">everything u are</option>
      <option value="assets/audio/Backburner.mp3">Backburner</option>
      <option value="assets/audio/Someone To You.mp3">Someone To You</option>
      <option value="assets/audio/Lampu kuning.mp3">lampu kuning</option>
      <option value="assets/audio/tresno tekan mati.mp3">tresno tekan mati</option>
      <option value="assets/audio/Bapak Mulyono Raja Tipu Tipu.mp3">Bapak Mulyono Raja Tipu Tipu</option>
    </select>
  </div>
  <button id="backBtn">Kembali</button>
</div>

<div id="overlay">
  <h1>GAME OVER</h1>
  <p>Ketuk layar untuk mulai lagi<br>atau tekan tombol di bawah untuk kembali ke menu</p>
  <button id="restartBtn">Mulai Lagi</button>
  <button id="backToMenuBtn">Kembali ke Menu</button>
</div>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");
const mainMenu = document.getElementById("mainMenu");
const loadingScreen = document.getElementById("loadingScreen");
const optionScreen = document.getElementById("optionScreen");
const overlay = document.getElementById("overlay");
const highScoreDisplay = document.getElementById("highScore");
const difficultySelect = document.getElementById("difficulty");
const soundOption = document.getElementById("soundOption");
const bgmSelect = document.getElementById("bgmSelect");

let highScore = localStorage.getItem("highScore") || 0;
highScoreDisplay.innerText = "High Score: " + highScore;

let bgm = new Audio();
let jumpSound = new Audio("assets/audio/jump .mp3");
let gameOverSound = new Audio("assets/audio/game over.mp3");
bgm.loop = true; bgm.volume = 0.5;
jumpSound.volume = 0.2;
gameOverSound.volume = 0.6;

function playBGM(){ if(!isSoundOn()) return; bgm.src = bgmSelect.value; bgm.play().catch(()=>{}); }
function stopBGM(){ bgm.pause(); bgm.currentTime = 0; }
function isSoundOn(){ return soundOption.value==="on"; }

setTimeout(()=>{ loadingScreen.style.display="none"; mainMenu.style.display="flex"; },3000);

document.getElementById("optionBtn").onclick=()=>{ mainMenu.style.display="none"; optionScreen.style.display="flex"; };
document.getElementById("backBtn").onclick=()=>{ optionScreen.style.display="none"; mainMenu.style.display="flex"; };
document.getElementById("playBtn").onclick=startGame;

bgmSelect.addEventListener("change",()=>{ if(!gameOver && isSoundOn()){ stopBGM(); playBGM(); } });

const images={
  run1:new Image(),run2:new Image(),run3:new Image(),
  jump1:new Image(),jump2:new Image(),jump3:new Image(),
  obstacle:new Image()
};
images.run1.src="assets/image/SMK_RUN_1.png";
images.run2.src="assets/image/SMK_RUN_2.png";
images.run3.src="assets/image/SMK_RUN_3.png";
images.jump1.src="assets/image/SMK_JUMP_1.png";
images.jump2.src="assets/image/SMK_JUMP_2.png";
images.jump3.src="assets/image/SMK_JUMP_3.png";
images.obstacle.src="assets/image/tongsampah.png";

let player, obstacles=[], frame, score, gameOver=false, difficulty;
let animationId=null; // üÜï buat nyimpen ID animasi aktif

function initGame(){
  difficulty = difficultySelect.value;
  let baseSpeed=6, obstacleCount=1, obstacleSpawnRate=300, playerMaxJump=1;
  if(difficulty==="easy"){ baseSpeed=5; playerMaxJump=1; }
  else if(difficulty==="normal"){ baseSpeed=6; playerMaxJump=1; }
  else if(difficulty==="hard"){ baseSpeed=8; obstacleCount=2; obstacleSpawnRate=200; playerMaxJump=2; }
  else if(difficulty==="veryhard"){ baseSpeed=10; obstacleCount=3; obstacleSpawnRate=150; playerMaxJump=2; }

  player={ x:100, y:300, width:90, height:90, vy:0, gravity:0.8, jumpPower:-12, grounded:true, jumpCount:0, maxJumps:playerMaxJump };

  obstacles=[];
  for(let i=0;i<obstacleCount;i++){
    obstacles.push({ x:800+i*obstacleSpawnRate, y:330, width:75, height:80, speed:baseSpeed });
  }

  frame=0; score=0; gameOver=false;
}

document.addEventListener("keydown",(e)=>{
  if(e.code==="Space" && !gameOver) jumpAction();
  if(gameOver && e.code==="Enter") startGame();
});
canvas.addEventListener("touchstart",()=>{ if(!gameOver) jumpAction(); else startGame(); });

function jumpAction(){
  if(player.grounded || player.jumpCount<player.maxJumps){
    player.vy=player.jumpPower; player.grounded=false; player.jumpCount++;
    if(isSoundOn()) jumpSound.play();
  }
}

function startGame(){
  // üÜï stop animasi lama dulu biar gak dobel
  if(animationId) cancelAnimationFrame(animationId);
  animationId=null;

  mainMenu.style.display="none"; canvas.style.display="block"; overlay.style.display="none";
  initGame(); if(isSoundOn()) playBGM();

  if(difficulty==="hard"||difficulty==="veryhard"){
    const tip=document.createElement("div");
    tip.innerText="üí° Double Jump Aktif!";
    tip.style.position="absolute"; tip.style.top="50px"; tip.style.left="50%";
    tip.style.transform="translateX(-50%)";
    tip.style.background="rgba(0,0,0,0.7)";
    tip.style.color="white"; tip.style.padding="10px 20px";
    tip.style.borderRadius="10px"; tip.style.zIndex="20"; tip.style.opacity="1";
    tip.style.transition="opacity 1s ease-out, top 1s ease-out";
    document.body.appendChild(tip);
    setTimeout(()=>{ tip.style.opacity="0"; tip.style.top="20px"; },2000);
    setTimeout(()=>{ tip.remove(); },3000);
  }

  animate();
}

function drawPlayer(){
  let sprite = player.grounded?[images.run1,images.run2,images.run3][Math.floor(frame/10)%3]:[images.jump1,images.jump2,images.jump3][Math.floor(frame/10)%3];
  ctx.drawImage(sprite,player.x,player.y,player.width,player.height);
}
function drawObstacles(){ obstacles.forEach(obs=>{ ctx.drawImage(images.obstacle,obs.x,obs.y,obs.width,obs.height); }); }
function drawScore(){ ctx.fillStyle="black"; ctx.font="20px Arial"; ctx.fillText("Score: "+score,10,30); ctx.fillText("High Score: "+highScore,10,55); }

function update(){
  frame++;
  player.y+=player.vy; player.vy+=player.gravity;
  if(player.y>300){ player.y=300; player.vy=0; player.grounded=true; player.jumpCount=0; }

  obstacles.forEach(obs=>{
    obs.x-=obs.speed;
    if(obs.x+obs.width<0){ obs.x=800+Math.random()*250; score++; if(score%100===0) obs.speed+=1; }

    const hitPlayer={ left:player.x+10,right:player.x+player.width-10,top:player.y+10,bottom:player.y+player.height-10 };
    const hitObs={ left:obs.x+5,right:obs.x+obs.width-5,top:obs.y+5,bottom:obs.y+obs.height };
    if(hitPlayer.right>hitObs.left && hitPlayer.left<hitObs.right && hitPlayer.bottom>hitObs.top+10){
      gameOver=true; showGameOverScreen(); if(isSoundOn()){ stopBGM(); gameOverSound.play(); }
      if(score>highScore){ highScore=score; localStorage.setItem("highScore",highScore); }
    }
  });
}

function showGameOverScreen(){
  if(animationId) cancelAnimationFrame(animationId); // üÜï stop animasi pas game over
  overlay.style.display="flex";
  document.getElementById("restartBtn").onclick=startGame;
  document.getElementById("backToMenuBtn").onclick=()=>{
    overlay.style.display="none";
    mainMenu.style.display="flex";
    canvas.style.display="none";
  };
  document.getElementById("restartBtn").addEventListener("touchstart",(e)=>{ e.preventDefault(); startGame(); });
  document.getElementById("backToMenuBtn").addEventListener("touchstart",(e)=>{ e.preventDefault(); overlay.style.display="none"; mainMenu.style.display="flex"; canvas.style.display="none"; });
}

function animate(){
  if(gameOver) return;
  ctx.clearRect(0,0,canvas.width,canvas.height);
  update(); drawPlayer(); drawObstacles(); drawScore();
  animationId=requestAnimationFrame(animate);
}
</script>
</body>
</html> 


